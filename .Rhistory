setwd("C:/Users/Busra/OneDrive/Masaüstü/Dosyalar/3-2-Dönem/da_ml_mid")
# Importing useful packages
pacman::p_load(pacman, dplyr, GGally, ggplot2, psych, ggthemes, igraph, CatEncoders, caTools, rpart, rattle,
ggvis, httr, lubridate, plotly, rio, rmarkdown, shiny, randomForest, datetime, rpart.plot,
stringr, tidyr, tidyverse, readr, reshape2, gridExtra, lubridate, ca, cluster, RColorBrewer)
# Reading the CSV file
data <-read.csv("android-games.csv", header=TRUE, sep=",")
#veri setinin ilk 6 satirina bakalim
head(data)
# Looking at the dimension of the data set.
dim(data)
# Looking at the structure of the data set.
str(data)
# Looking at the structure of the data set deeply.
glimpse(data)
# Are there null variables?
sum(is.na(data))
# Are there too many?
mean(is.na(data))
# Cleaning up null values.
# Assign it to the clean(cl) -cldata-
cldata <- na.omit(data)
head(cldata)
tail(cldata)
# Checking out for the null variables.
sum(is.na(cldata))
summary(cldata)
str(cldata)
dim(cldata)
describe(cldata)
cldata$Category <- as.factor(cldata$Category)
cldata$Installs <- as.factor(cldata$Installs)
cldata$Genres <- as.factor(cldata$Genres)
cldata$Android.Ver <- as.factor(cldata$Android.Ver)
# Checking out for the factor variables.
glimpse(cldata)
cldata = subset(cldata)
#plotting a bar graph for categories
ggplot(aes(x = Category), data = cldata)+
geom_bar(fill = 'red')+
coord_flip()+
ggtitle("Categories")
#Cleaning the installs column
cldata = subset(cldata, df$Installs)
#plotting a bar graph for level of installs.
ggplot(aes(x = Installs), data = cldata )+
geom_bar(fill = 'blue')+
coord_flip()+
ggtitle('Installs')
#Cleaning the installs column
cldata = subset(cldata, df$Installs != 'Free')
#plotting a bar graph for level of installs.
ggplot(aes(x = Installs), data = cldata )+
geom_bar(fill = 'blue')+
coord_flip()+
ggtitle('Installs')
#Cleaning the installs column
cldata = subset(cldata, df$Installs != 'Free')
#plotting a bar graph for level of installs.
ggplot(aes(x = Installs), data = cldata )+
geom_bar(fill = 'blue')+
coord_flip()+
ggtitle('Installs')
#Cleaning the installs column
cldata = subset(cldata, df$Installs)
#plotting a bar graph for level of installs.
ggplot(aes(x = Installs), data = cldata )+
geom_bar(fill = 'blue')+
coord_flip()+
ggtitle('Installs')
#A histogram for the distribution of ratings in the google play dataset
med = median(subset(cldata$Rating, cldata$Rating >= 0.01))
#Histogram
ggplot(aes(x = Rating), data = cldata )+
geom_histogram(binwimlh = 0.1, fill = 'yellow')+
xlim(1,5)+
geom_vline(xintercept = med, col = 'blue')+
ggtitle('Rating')
#plot the average rating for each category
dfcat <- subset(cldata, !is.na(Rating))
dfcat <- dfcat%>%
group_by(Category)%>%
summarise(Rating = mean(as.numeric(Rating)))
ggplot(aes(x = Category, y = Rating), data = dfcat)+
geom_bar(stat="identity", fill = 'violetred2')+
coord_flip(ylim = c(3.8,4.5))
#the relationship between price and category when accounting for the type
ggplot(aes(y = Price, x = Category), data = cldata)+
geom_point(alpha = 0.2, color = 'tomato')+
coord_flip()+
ggtitle('Price vs. Category')
### Exploring the ratings given to the apps, categorically
cldata %>%  group_by(Category) %>%
filter(!is.na(Rating), Category!='1.9') %>%
summarise(meanRating = mean(Rating)) %>%
ggplot(mapping = aes(x = Category, y = meanRating)) +
geom_col(aes(fill = Category)) +
geom_line(group = 1) +  coord_flip() +
ggtitle("Average rating across categories") + ylab("Average rating") + guides(fill=FALSE)
###Distribution of Ratings Across Categories
cldata %>% filter(Category!='1.9') %>%
ggplot(mapping = aes(x = Rating, fill = Category)) +
geom_histogram(bins = 50, position = "identity") + xlim(0,5) +
facet_wrap(~Category) + guides(fill = FALSE) +
ggtitle("Distribution of ratings across categories") + ylab("Count")
